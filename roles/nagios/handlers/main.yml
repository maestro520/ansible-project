---
- name: Validate and restart Nagios
  block:
    - name: Validate Nagios configuration
      command: /usr/sbin/nagios -v /etc/nagios/nagios.cfg
      register: nagios_validate
      failed_when: nagios_validate.rc != 0
    - name: Restart Nagios
      systemd:
        name: nagios
        state: restarted
    - name: Restart HTTPD
      systemd:
        name: httpd
        state: restarted

